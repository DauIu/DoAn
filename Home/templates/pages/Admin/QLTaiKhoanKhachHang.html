<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    {% extends "layout/admin.html" %}
    <title>{% block title %} Quản lý Tài khoản Khách hàng {% endblock %}</title>
    {% load static %}
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
</head>
<body>
    {% block content %}
    <div class="row">
        <div class="col-12">
            <h2>Danh sách Tài khoản Khách hàng</h2>
        </div>
    </div>

    <table class="table table-hover mt-3">
        <thead class="table-success">
            <tr>
                <th class="text-center" style="width: 5%;">STT</th>
                <th style="width: 25%;">Tên Tài khoản</th>
                <th style="width: 20%;">Email</th>
                <th class="text-center" style="width: 20%;">Ngày đăng nhập gần nhất </th>
                <th class="text-center" style="width: 20%;">Vô hiệu hóa</th>
            </tr>
        </thead>
        <tbody>
            {% for user in dsTaiKhoanKhachHang %}
            {% if not user.is_admin %} <!-- Bỏ qua tài khoản admin -->
            <tr>
                <th scope="row" class="text-center">{{ forloop.counter }}</th>
                <td>{{ user.username }}</td>
                <td>{{ user.email }}</td>
                <td class="text-center">
                    {% if user.ngaydangnhap %}
                        {{ user.ngaydangnhap|date:"d/m/Y" }}
                    {% else %}
                        <span>Chưa đăng nhập</span>
                    {% endif %}
                </td>
                <td class="text-center">
                    {% if not user.is_active %}
                    <!-- Hiển thị nếu tài khoản đã vô hiệu hóa -->
                    <a class="btn btn-success"
                       href="{% url 'UserMember:toggle_user_status' user.id %}?action=activate"
                       onclick="return confirm('Bạn có chắc chắn muốn kích hoạt lại tài khoản này không?');">
                       Kích hoạt
                    </a>
                    {% else %}
                    <!-- Nút để vô hiệu hóa tài khoản -->
                    <a class="btn btn-warning"
                       href="{% url 'UserMember:toggle_user_status' user.id %}?action=deactivate"
                       onclick="return confirm('Bạn có chắc chắn muốn vô hiệu hóa tài khoản này không?');">
                       Vô hiệu hóa
                    </a>
                    {% endif %}
                </td>
                
            </tr>
            {% endif %}
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">Không có tài khoản khách hàng nào</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% comment %} <div class="container mt-3">
        {% if messages %}
            <div class="alert alert-info" role="alert">
                {% for message in messages %}
                    <div>{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    </div> {% endcomment %}
    {% endblock %}
</body>
</html>
