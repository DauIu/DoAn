<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    {% extends "layout/layout.html" %}
    <title>{% block title %}Khôi phục mật khẩu{% endblock %}</title>
</head>
<body>
    {% block content %}
    {% load static %}
    <!-- Page Header -->
    <div class="container-fluid page-header mb-5 wow fadeIn" data-wow-delay="0.1s">
        <div class="container d-flex justify-content-end">
            <h1 class="display-3 mb-3 animated slideInDown" style="font-weight:800; font-size:72px; opacity: 0.9;">Khôi phục</h1>
        </div>
    </div>
    <div class="section-header text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 800px;">
        <h1 class="display-3 mb-3">Khôi phục mật khẩu</h1>
        <p>Điền email mà bạn đã đăng ký trước đó để khôi phục mật khẩu.</p>
    </div>
   <!-- Recover Password Form (initially hidden) -->
    <div id="recover-password-form" class="mt-4 d-flex justify-content-center align-items-center">
        <div class="card shadow-sm p-4" style="max-width: 400px; width: 100%; border-radius: 8px;">
            <form method="post" action="{% url 'UserMember:Recover' %}" id="recover-form">
                {% csrf_token %}
                <div class="form-floating mb-3">
                    <input type="email" name="Email" class="form-control" id="recover-email" placeholder="Nhập Email để lấy lại mật khẩu" required>
                    <label for="recover-email">Email</label>
                </div>
                <div class="d-grid">
                    <button type="submit" class="btn btn-success" style="border-color: #007bff;">
                        Lấy lại mật khẩu
                    </button>
                </div>
            </form>
            
        </div>
    </div>
    <script>
        document.getElementById('recover-form').addEventListener('submit', function (e) {
            e.preventDefault(); // Ngăn trình duyệt gửi form theo cách mặc định

            const form = e.target;
            const formData = new FormData(form);
            const url = form.action;

            fetch(url, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': formData.get('csrfmiddlewaretoken')
                }
            })
                .then(response => response.json().then(data => ({ status: response.status, body: data })))
                .then(({ status, body }) => {
                    if (status === 200) {
                        alert(body.message); // Hiển thị thông báo thành công
                    } else {
                        alert(body.message || 'Đã xảy ra lỗi. Vui lòng thử lại.'); // Hiển thị lỗi từ server
                    }
                })
                .catch(error => {
                    alert('Có lỗi xảy ra. Vui lòng thử lại sau.'); // Thông báo lỗi nếu có vấn đề không mong muốn
                });
        });

    </script>
        {% endblock %}
</body>
</html>
